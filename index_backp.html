<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Magnehelic</title>
  </head>
  <canvas id="myChart" width="400" height="400"></canvas>
    

  <script>
    // You can also require other files to run in this process
    require('./renderer.js');
	var Chart = require('chart.js')
	var LineByLineReader = require('line-by-line'),
	
	lineCounter = 0;
	
	MeasureData = {
		index : new Array(),
		date : new Array(),
		time : new Array(),
		pressure : new Array(),
		unit : new Array()
	}
	
	logData = Object.create(MeasureData);
	
    lr = new LineByLineReader('./log.txt');
	
	lr.on('line', function (line) {
		if(lineCounter) {
			logData.index.push(parseInt(line.substring(4, 6)));
			logData.date.push(new Date(line.substring(8, 18)));
			logData.time.push(new Date().getTime(line.substring(19, 27)));
			logData.pressure.push(line.substring(37, 41)*1);
			logData.unit.push(line.substring(50, 54));
		}
		else {
			if(line.toString() == ' Index  ---date--- --time--      Pressure         unit') {
				lineCounter++;
			}
		}
		//console.log(line);
	});
	lr.on('end', function() {
		lineCounter = 0;
		
		console.log(logData.index)
		console.log(logData.date)
		console.log(logData.time)
		console.log(logData.pressure)
		console.log(logData.unit)
		
		// MAKE CHART
		var ctx = document.getElementById("myChart");
		var scatterChart = new Chart(ctx, {
			type: 'line',
			data: {
				datasets: [
				{
					label: 'Scatter Dataset',
					data: [{
						x: -10,
						y: 0
					}, {
						x: 0,
						y: 10
					}, {
						x: 10,
						y: 5
					}]
				},
				{
					label: 'Scatter Dataset',
					data: [{
						x: 11,
						y: 0
					}, {
						x: 0,
						y: 12
					}, {
						x: 10,
						y: 5
					}]
				}]
			},
			options: {
				scales: {
					xAxes: [{
						type: 'linear',
						position: 'bottom'
					}]
				}
			}
		});
	});
  </script>
</html>
